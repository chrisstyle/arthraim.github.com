
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Artoirus</title>
	<meta name="author" content="Arthur Wang">

	
	<meta name="description" content="很久没有写博客了，已经有友联的童鞋抱怨了，最近这段时间很忙，几乎下班就没心情做自己的事情了。话说最近入手了一台WP7，三星focus，白菜价，手机丢了所以来不及等Nokia Lumia 800了，很急就入手了。话说这不是重点，我手痒然后卸掉了WP7sdk的beta2，装上了新的7.1，小玩了一下 &hellip;">
	
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="Artoirus" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
</head>

<body>
	<header id="header" class="inner"><h1><a href="/">Artoirus</a></h1>
<nav id="main-nav"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul class="main">
	<li><a href="/">Blog</a></li>
	<li><a href="/blog/archives">Archives</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="https://www.google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:artori.us">
			</form>
		</div>
	</div>
</nav>
<nav id="sub-nav" class="alignright">
	<div class="social">
		
		
		
		
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
	<form class="search" action="https://www.google.com/search" method="get">
		<input class="alignright" type="text" name="q" results="0">
		<input type="hidden" name="q" value="site:artori.us">
	</form>
</nav>

</header>
	
		
	
	<div id="content" class="inner">


    <article class="post">
	<h2 class="title">
		
		<a href="/windows-phone-wbt/">
		
			Windows Phone版微博通</a>
	</h2>
	<div class="entry-content">
		<p>很久没有写博客了，已经有友联的童鞋抱怨了，最近这段时间很忙，几乎下班就没心情做自己的事情了。话说最近入手了一台WP7，三星focus，白菜价，手机丢了所以来不及等Nokia Lumia 800了，很急就入手了。话说这不是重点，我手痒然后卸掉了WP7sdk的beta2，装上了新的7.1，小玩了一下。</p>

<p>话说其实给WP7写应用还真的蛮好玩的，事实上marketplace实际上也比我想象的要热闹一点，所以还蛮有动力写点东西的，最近在公司写iOS的app，每天都是objective-c，捡起了以前的C#真是一下子觉得好厉害，一个天一个地啊，终于不用自己retain, release了。</p>

<p>对了写了两段还是没有说到重点，因为重点就一句话，在熟悉WP7的开发，所以写了个微博通的客户端，好吧只是调用api发个post的请求而已很简单，主要是自己熟悉一下。</p>

<p>对了东西已经开源了在<a href="https://github.com/Arthraim/WbtoMongo">这里</a></p>

<p>那写到这里就写完了。感叹一下，visual studio真的不错，现在.net的包管理也很方便！现在dotnet我已经算是局外人了，所以不嘴贫了 -。-</p>

<p>以上</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-12-12T00:53:41+08:00" pubdate data-updated="true">Dec 12<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/programing/'>Programing</a>


</div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/ruby-is-horribl/">
		
			Ruby好可怕</a>
	</h2>
	<div class="entry-content">
		<p>接触ruby时间不长，用的机会就更少了，所以偶尔用一下的时候难免还要去翻翻文档什么的。维护某个后台的时候，有个随机输出的需求，所以我写了下面这样一段代码。</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>  <span class="n">ver</span> <span class="o">=</span> <span class="n">params</span><span class="o">[</span><span class="ss">:version</span><span class="o">]</span> <span class="o">==</span> <span class="kp">nil</span> <span class="p">?</span> <span class="s1">&#39;i&#39;</span> <span class="p">:</span> <span class="n">params</span><span class="o">[</span><span class="ss">:version</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'>  <span class="vi">@preview_items</span> <span class="o">=</span> <span class="no">MyItem</span><span class="o">.</span><span class="n">where</span><span class="p">({</span><span class="ss">:version</span> <span class="o">=&gt;</span> <span class="n">ver</span><span class="p">,</span> <span class="ss">:order</span><span class="o">.</span><span class="n">gt</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="o">[</span><span class="ss">:order</span><span class="p">,</span> <span class="ss">:desc</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">map</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'>  <span class="vi">@preview_items</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="o">|</span>
</span><span class='line'>    <span class="n">order</span> <span class="o">=</span> <span class="n">item</span><span class="o">[</span><span class="s1">&#39;order&#39;</span><span class="o">]</span>
</span><span class='line'>    <span class="n">map</span><span class="o">[</span><span class="n">order</span><span class="o">]</span> <span class="o">=</span> <span class="o">[]</span> <span class="k">if</span> <span class="n">map</span><span class="o">[</span><span class="n">order</span><span class="o">]</span> <span class="o">==</span> <span class="kp">nil</span>
</span><span class='line'>    <span class="n">map</span><span class="o">[</span><span class="n">order</span><span class="o">].</span><span class="n">push</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="vi">@json_items</span> <span class="o">=</span> <span class="o">[]</span>
</span><span class='line'>  <span class="n">map</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="o">|</span>
</span><span class='line'>    <span class="n">arr</span> <span class="o">=</span> <span class="n">map</span><span class="o">[</span><span class="n">key</span><span class="o">]</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">arr</span><span class="o">.</span><span class="n">count</span> <span class="o">==</span> <span class="mi">1</span>
</span><span class='line'>      <span class="vi">@json_items</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">arr</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="vi">@json_items</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="n">arr</span><span class="o">[</span><span class="nb">rand</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">count</span><span class="p">)</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="n">render</span> <span class="n">json</span><span class="p">:</span> <span class="vi">@json_items</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">params</span><span class="o">[</span><span class="ss">:callback</span><span class="o">]</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>rails某个模型的index页面，具体做了什么呢？大概是四件事情：</p>

<ol>
<li><p>取参数version</p></li>
<li><p>在数据库查询该version并且order字段大于0的数据，根据order字段倒叙排列（数据库是mongodb，driver用mongoid）</p></li>
<li><p>遍历查询的结果建立一张以order为key，相应order的实体数组为value的表</p></li>
<li><p>遍历3中的表，每个order的数组中随机抽取一个元素作为这个order的唯一值</p></li>
</ol>


<p>最后把获取的新数据render。</p>

<p>看起来很满足什么的，就提交代码了。之后同事部署前，看了看这里的更新，然后最终把代码完全改掉了。只用了一行 =。=</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>  <span class="vi">@json_items</span> <span class="o">=</span> <span class="no">MyItem</span><span class="o">.</span><span class="n">where</span><span class="p">({</span><span class="ss">:version</span> <span class="o">=&gt;</span> <span class="n">params</span><span class="o">[</span><span class="ss">:version</span><span class="o">]</span> <span class="o">||</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="ss">:order</span><span class="o">.</span><span class="n">gt</span> <span class="o">=&gt;</span> <span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="o">[</span><span class="ss">:order</span><span class="p">,</span> <span class="ss">:desc</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>    <span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="o">&amp;</span><span class="ss">:order</span><span class="p">)</span><span class="o">.</span><span class="n">map</span> <span class="p">{</span><span class="o">|</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="o">|</span> <span class="n">v</span><span class="o">.</span><span class="n">sample</span><span class="p">}</span>
</span><span class='line'>  <span class="n">render</span> <span class="n">json</span><span class="p">:</span> <span class="vi">@json_items</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">params</span><span class="o">[</span><span class="ss">:callback</span><span class="o">]</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>做的事情是完全一样的。</p>

<ol>
<li><p>他先看了取参数，不用三元，直接 || 一个默认值</p></li>
<li><p>然后他把第4步中的取随机的部分改了，因为数组中随机取一个元素，ruby直接有sample方法</p></li>
<li><p>然后他又觉得第四步可以更简单的调用hash的map方法，映射成另一个value = value.sample的map</p></li>
<li><p>最后他吃了顿中饭回来灵光一闪，终于发现第三步做的就是一个group_by的事情，ruby可以做这个事情</p></li>
</ol>


<p>于是，除了查询不变，所有的逻辑全部调用了ruby现成的方法完成了！哥落伍了…… 越发觉得ruby好强大。</p>

<p>BTW，帮我改代码的是@niedhui</p>

<p>以上……</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-09-11T20:40:56+08:00" pubdate data-updated="true">Sep 11<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/programing/'>Programing</a>


</div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/nomethoderror-undefined-method-specifications/">
		
			NoMethodError: Undefined Method `specifications&#8217; &#8230;</a>
	</h2>
	<div class="entry-content">
		<p>今天在和同事说，我最喜欢写这样的文章了，很多人会碰到的异常，而且没有什么中文资料，可以给搜索引擎个好排名（喂你心机好重。好吧其实我的想法很伟大的哦，我是给以后会遇到一样问题的你造福哦~</p>

<p>重新搭新环境，先装了rvm，然后装上gem，用gem装了rails。之后呢问题就出来，尝试用bundle exec rake db:seeds的时候会出错，加上&#8211;track参数一看大概是这样子。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>undefined method `specifications' for "/Users/arthraim/.rvm/gems/ruby-1.9.2-p290":String</span></code></pre></td></tr></table></div></figure>


<p>好像后面也不是特别重要了，只是这个问题比较费解，之前同事好像也遇到过。去Google了一下，居然是gem版本太高的关系，要把gem降级到早一些的版本。不想深究下去了，就说一下解决的办法好了。</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>gem update --system 1.7.2</span></code></pre></td></tr></table></div></figure>


<p>之前我的版本是1.8.5，虽然不知道具体什么情况，不过1.7.2就可以了。话说gem update到老版本的方法好神奇 -。-</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-07-21T05:11:17+08:00" pubdate data-updated="true">Jul 21<span>st</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/programing/'>Programing</a>


</div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/the-update-of-rubygems-causes-yaml-parsing-problem/">
		
			RubyGems升级造成yaml Parse错误</a>
	</h2>
	<div class="entry-content">
		<p>遇到个很蛋疼的问题，mongoid的配置文件（一个YAML）文件引发了下面这个错误：</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>db_name must be a string or symbol
</span><span class='line'>...MONGOID_PATH/lib/mongo/util/support.rb:50:in `validate_db_name'</span></code></pre></td></tr></table></div></figure>


<p>Google到<a href="http://cstrahan.com/2011/05/14/mongoid-yaml-rails-conflict.html">这里</a>，知道原因是RubyGem v1.5.0开始把默认的yaml parser从syck改成了psych。</p>

<p>解决方法一当然是改你的yaml让它可以被parse，如果需要使用之前的parser，那要在config/environment.rb中加上以下两行</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>require 'yaml'
</span><span class='line'>YAML::ENGINE.yamler= 'syck'</span></code></pre></td></tr></table></div></figure>


<p>话说这好像是第一次写ruby/rails的文章，刚刚玩了两三个星期~</p>

<p>以上</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-06-29T11:10:44+08:00" pubdate data-updated="true">Jun 29<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/programing/'>Programing</a>


</div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2011-e3-press-conferences/">
		
			三大游戏主机厂商2011年E3展前发布会</a>
	</h2>
	<div class="entry-content">
		<p>在北京时间昨天0点30分，今天昨天上8点和今天凌晨0点，微软、索尼、任天堂三大游戏主机厂商的E3展前发布会依次召开。集结第一方第三方各种游戏阵容及对硬件平台的更新换代，三大厂商都给今年E3注入了一针兴奋剂，注定是一个同样不平凡的E3将要开始。</p>

<p>微软的展前发布会是最平淡的，大量的KINECT游戏介绍、XBOX LIVE的各种升级，以及其他CU（core user核心玩家）的软件，但是惟独缺少了新的硬件，无论是新外设还是X720，更别说微软掌机，一样都没有出现。唯一的亮点就是压轴的HALO4，这也是唯一让我骂娘的牛B消息。</p>

<p><a href="/2011-e3-press-conferences/2011_e3_microsoft/"><img src="/images/uploads/wp/2011_e3_microsoft-500x281.jpg" alt="" /></a></p>

<p>索尼的展前发布会之前，NGP已经在各种场合出现过了，伴随着PSN故障的道歉，各种软件的介绍，等到平井一夫上台的时候，大家知道今年的重头戏来了 &#8212;- NGP。和之前传闻一样，NGP的真名的确是Playstation Vita（生命）。当然PSV的硬件规格早就不是秘密，不过发售计划和价格才是人们关注的焦点，接近PS3技能的掌机，几乎应该是不敢想象的昂贵。不过事实证明索尼赢了，&#8221;业界最后的良心&#8221;是大家的评论，PSV售价24800日元（249.9美元），哪怕是3DS也要25000日元，索尼这个价格实在是太震撼了！</p>

<p>另外索尼公布的3D电视利用LL/RR的眼镜原理可以让两名玩家看到完全不同的画面，这样一来夫妻两个盯着同一个屏幕一个看电视一个玩游戏的梦想不远了！唯一的遗憾是两个人都要带着有色眼镜看电视了。</p>

<p><a href="/2011-e3-press-conferences/2011_e3_sony/"><img src="/images/uploads/wp/2011_e3_sony-500x280.jpg" alt="" /></a></p>

<p>十来分钟前结束的任天堂展前发布会应该是最精彩的，在展前沸沸扬扬的project cafe新主机，以及后来爆出来的控制器上会有6寸液晶屏，这下都真相大白了。任氏一样用第一方的软件砸，然后第三方的阵容也的确是牛X。最震撼的是在发布会的最后一项，大肆介绍了新一代的主机WiiU。正是之前的控制器。但是这个东西很神奇，虽然猩猩和岩田聪都称之为：new controller。但EA和其他第三方纷纷称其：new platform, new console或new system。究竟只是一个wii的控制器还是一台新的家用机掌机合体，大家都应该明白了，毕竟wii是不支持HD的，其实project cafe的主机和控制器之和就是今天的wiiU，可不是只有一个控制器而已哦~</p>

<p><a href="/2011-e3-press-conferences/2011_e3_nintendo/"><img src="/images/uploads/wp/2011_e3_nintendo-500x281.png" alt="" /></a></p>

<p>E3每天都在恢复往日的气息，伴随着3DS/KINECT甚至NGP/WIIU的出现，E3也真的回来了，复苏了。势必明年的E3会有PS4 X720甚至WII2的出现，让我们好好欣赏今年的E3，并期待它有更大的发展吧~</p>

<p>以上。</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-06-08T09:38:41+08:00" pubdate data-updated="true">Jun 8<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/video-game/'>Video Game</a>


</div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/java-oauth-lib-scribe-java-start-supporting-weibo/">
		
			Java语言oauth库scribe-java支持新浪微博</a>
	</h2>
	<div class="entry-content">
		<p>好吧这是一篇蛋疼的文章, 因为本人第一次成功pull request所以比较鸡冻. <a href="https://github.com/fernandezpablo85/scribe-java">scribe-java</a>是一个java语言的oauth库, 代码很干净利落很容易扩展而且用起来很方便. 因为<a href="/something-about-oauth/">之前文章</a>提到过的工作, 所以对scribe-java做了<a href="https://github.com/Arthraim/scribe-java">一些改造</a>.</p>

<p>事实上很多改造是因为scribe-java的确还存在一些问题, 比如oauth参数不支持querystring等, 所以改造工作不可避免. 不过随着作者非常快速的更新, 现在它已经大大改善了这些方面的功能. 回过头来再看自己的folk, 事实上也完全没有必要了.</p>

<p>当然很希望国内的开发者在pom.xml里写上scribe-java就可以直接支持国内的各个微博, 所以我整理了一下我的分支正式的发起了pull request. 经过几次交流, 最终 新浪微博 / 网易微博 / 搜狐微博 的相关支持已经正式纳入了原作者的版本中得到支持了. 另外我一起提出请求的QQ微博和人人2.0最终因为代码的修改太大, 作者没有采纳(如果你要使用, 可以下载<a href="https://github.com/Arthraim/scribe-java">我的folk</a>.</p>

<p>具体用法欢迎参考<a href="https://github.com/fernandezpablo85/scribe-java/blob/master/src/test/java/org/scribe/examples/SinaWeiboExample.java">这个例子</a> :) 开源是个尝到甜头就像继续下去的工作, 哪怕你的贡献再渺小, 也非常的美好. 让我鸡冻的感谢一下原作者Pablo Fernandez, 来自阿根廷.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-06-04T07:41:22+08:00" pubdate data-updated="true">Jun 4<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/programing/'>Programing</a>


</div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/bottle-i-love-this-framework/">
		
			Bottle-非常喜欢这个框架</a>
	</h2>
	<div class="entry-content">
		<p>大概是我火星了，直到2天前我才知道有bottle这样一个框架。鉴于对自己的翻译能力没有什么信心，就摘抄<a href="http://bottlepy.org">bottle官网</a>上对自己介绍的原文过来吧。</p>

<blockquote><p>Bottle is a fast, simple and lightweight WSGI micro web-framework for Python. It is distributed as a single file module and has no dependencies other than the Python Standard Library.</p></blockquote>

<p>坦率说因为工作中是使用spring的缘故，其实真正用python的web框架机会并不多。相对接触的比较多的是django，无论是工作中还是生活中写点小东西的时候我还是比较愿意使用django，django+mongoengine，可以快速的使用mongodb来做存储，具体就不细说了这不是重点，<a href="/use-mongodb-with-django/">之前的文章</a>中提到过。至于pylons, web.py或者其他的，大概看了一眼文档就没啥特别的感觉就没有深究下去。</p>

<p><a href="/bottle-i-love-this-framework/logo_nav/"><img src="/images/uploads/wp/logo_nav.png" alt="" /></a></p>

<p>今天主角是bottle，早上醒来迷迷糊糊在reader上看了<a href="http://simple-is-better.com/news/detail-292">一个充满印度腔的视频</a>，讲用bottle框架5分钟创建一个wiki。就是这个视频让我对bottle一见钟情。可以看一下官网的helloworld</p>

<p><a href="/bottle-i-love-this-framework/2011-05-29_bottle_hello_world/"><img src="/images/uploads/wp/2011-05-29_bottle_hello_world.png" alt="" /></a></p>

<p>好像做一个restful的东西好轻松的样子，直到我花了2个小时认真的读了他的<a href="http://bottlepy.org/docs/dev/tutorial.html">这一页</a>文档，我才觉得这真的太棒了！搭建一个web应用真的是手到擒来鸟。dict直接输出为json，multipart上传文件直接从request.files里面读取，cookie以及加密的cookie等等偷懒的feature真是不少。</p>

<p>内建的template相对要蛋疼一点，我都没有找到loop，不过支持mako很简单，和内建的用法几乎是一模一样的。</p>

<p>各种给力不多说了，现在自己在写一个用bottle+mongo的应用玩，另外学习的时候写了<a href="https://gist.github.com/994641">一个例子</a>，也传到了github上，愿意的话可以看看，里面有很多让人高兴的地方。如果你和我一样有做一个web应用的冲动，不妨试试看bottle！</p>

<p>以上。</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-05-30T04:46:07+08:00" pubdate data-updated="true">May 30<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/programing/'>Programing</a>


</div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/something-about-oauth/">
		
			随便写写oauth</a>
	</h2>
	<div class="entry-content">
		<p>最近用到了其他微博的oauth, 起初觉得oauth很烦, 因为文档看了很久很久都没有弄明白怎么回事. 等到初步模到了一些门道之后, 发现其实挺简单的, 因为那是一个标准, 理论上只要支持oauth的网站用一套代码去跑基本上都可以通过. 不过在实际的应用当中我算是领教到了中国互联网的强悍之处. 已经不记得是在什么地方看到一篇文章, 作者一上来第一句话就是 &#8220;从oauth可以看出一个互联网企业的技术力&#8221;, 虽然稍微有些偏激, 但多多少少有值得认同的地方.</p>

<p><strong>我了解的oauth</strong></p>

<p>oauth其实是个认证, 就和HTTP的basic auth一样, 通过认证才能访问HTTP的资源. 之所以需要oauth, 只是为了解决一个问题:&#8221;第三方不获得用户第一方的密码的前提下访问第一方的资源&#8221;, 所以保障用户通信过程中密码不被泄露是其次, 关键更重要的是第三方不会获得用户名和密码.</p>

<p>于是强大的地方就这样显现出来了, 不知道大家有没有看到过新浪微博的xauth, 什么是xauth呢? 我没有去考据究竟xauth是谁的创造, 它几乎搬了大部分oauth的内容, 不过解决了一个什么问题呢? 解决了一个 &#8220;oauth认证必须跳转到第一方去输入密码&#8221; 的问题(美其名曰提升用户体验). 对不起我凌乱了, 第三方是可以得到用户密码的, 那它是不是直接把oauth的第一大feature给OOXX掉了 - - 那basic auth不能满足你么大哥?</p>

<p><strong>各大网站的oauth</strong></p>

<p>因为工作和兴趣双重因素所致(这真是个难得一遇的好事情), 我接触了各个门户的oauth, 首先有个前提就是我用了oauth.net上罗列的某个java的oauth库, 饱受挫折, 经过几周的积累, 我才决定写下这篇文章, 多多少少对后来者有所提示和帮助.</p>

<p><strong>新浪微博</strong></p>

<p>把新浪放在第一家只是因为我第一个做的是新浪微博的oauth, 一上来使用了一个库叫做<a href="http://code.google.com/p/oauth-signpost/">oauth-signpost</a>, 看上去挺不错的样子, 尝试了一下它对Google等国外网站的例子, 我觉得可以用, 于是开始写. 之后马上就遇到了问题, 在申请request_token的过程中, 服务器会返回一个oauth_callback_confirmed的参数, 这个是明确写在oauth 1.0标准中的 (原先的1.0a, 如今已正式merge到了1.0中, 感兴趣的话<a href="http://www.skiyo.cn/2010/08/23/oauth-1-0a-and-1-0/">这里</a>有一篇资料描述了1.0a和早期1.0的差异), 是必须有的, 可是如果你是通过POST方法请求, 那么很抱歉新浪微博是没有提供的. 这显然是一个疏漏. 在新浪微博官方论坛里, 这个问题不止一次的被提到(看<a href="http://forum.open.t.sina.com.cn/read.php?tid=1838">这里</a>, 看<a href="http://forum.open.t.sina.com.cn/read.php?tid=912&amp;ordertype=desc">这里</a>,), 虽然说是 &#8220;近期会加上&#8221; 不过感觉新浪要改应该不会那么敏捷, 所以能做的只有耐心等待和回避这个问题. (虽然不影响正常功能, 不过毕竟人家是标准, signpost就是属于那种按照标准来结果在新浪出错了的牺牲品)</p>

<p>为了回避这个问题, 我改用了<a href="https://github.com/fernandezpablo85/scribe-java">scribe-java</a>这个库. 不过在做新浪微博的时候发现的问题, 好像只有这一个.</p>

<p><strong>网易微博</strong></p>

<p>网易是在我快速尝试了搜狐/豆瓣/腾讯之后成功完成的第二个, 事实上很幸运, 基本上不用改太多的代码就完成了网易的功能. 虽然这样, 并不表示网易就按照标准来, 首先我发现的明显的一个不按照标准的地方是authorization步骤, 它提供了两个接口, 一个是/oauth/authorize, 一个是/oauth/authenticate, 首先我先申明这两个单词我一直搞不清, 不过在网易给oauth的分工中, 它们的工程师是这么定义的: authorize不处理callback, 直接展示verifier的页面; 另一个, authenticate则处理callback. (至于给第二个传oob会怎么样, 有没有返回oauth_callback_confirmed, 我都没有细看了)</p>

<p>另外小提一下, 它在回调你的callback地址的时候, 传的参数名是oauth_token, 不过相信我, 我觉得那是oauth_verifier.</p>

<p><strong>腾讯微博</strong></p>

<p>对腾讯微博(QQ微博)的尝试其实在网易之前, 不过才看了文档我就挂掉了, 因为它不支持header传递oauth参数, 只支持querystring, 虽然的确在oauth协议中写出可以使用querystring, 不过我觉得header比较帅气可不可以啊, 而且我的库不支持querystring啊企鹅大哥 - -</p>

<p>大问题放前面, 后面还有小问题呢. 在请求request_token时传递oauth_callback参数, 因为写测试没用到callback, 所以肯定库会帮我填上oob(out-of-bound), 不过让我很崩溃的是企鹅大爷不高兴了, 给我跳转到了一个这样一个地方: https://open.t.qq.com/oauth_html/oob?oauth_token=xxxxx&amp;oauth_verifier=xxxxxx, 这当然是NOT FOUND, 这是企鹅大哥的地盘, 我不能做主啊.</p>

<p>千辛万苦查到了企鹅大哥的文档里写了这么一句话: <strong>① 用户授权后web应用将会重定向到oauth_callback。当应用为pc客户端或手机客户端应用时，没有回调url(oauth_callback)的概念，此时设置为字符串null即可。字符串&#8221;null&#8221;必须是小写。</strong>爹啊&#8230; 你是我亲爹啊. 不按套路出牌的啊! (<a href="http://open.t.qq.com/bbs/viewthread.php?tid=2352">愤怒的同学</a>显然不止我一个, 而且没人理他)</p>

<p>对了, 今天还发现腾讯微博开发平台的文档修改过了, 不过&#8230;&#8230;&#8230;&#8230;.. 被修改的似乎只有文档而已.</p>

<p><strong>搜狐微博</strong></p>

<p>申请搜狐博客应用的时候填写了一个callback, 不知道是干吗的. 另外看了一些人写的东西, 说搜狐不让传realm. 我用之前的代码跑了一下, 结果报错说signature_invalid, 我想这东西估计不靠谱就先放下去做网易微博了. 今天下午回过头来去再摸了摸搜狐微博, 想不到一下子就跑通了, 可喜可贺, 不知道是不是它最近几天有更新, 还是我第一次的尝试实在太潦草以至于自己出错了错怪了搜狐. 不过搜狐微博的开发文档写的真不怎么样, 相比起来前三家好多了.</p>

<p>还有一个问题是搜狐不理会我的oauth_callback, 除非在authorize的时候传(querystring, 和oauth_token一起传), 不过这应该是oauth 1.0a就改掉的地方, 搜狐大概是没有跟上?</p>

<p><strong>豆瓣</strong></p>

<p>你们知道, 作为一个程序员, 对豆瓣的崇拜之情是难以言表的. 豆瓣的高性能, 以及豆瓣为开源做出的各种贡献都是围城外面的程序员羡慕不已的, 并且把 &#8220;指环王&#8221; 当作文化的豆瓣团队也给我留下了足够美好的印象. 熟悉python的朋友不会不知道simple is better than complex这句话, 用python开发的豆瓣无论如何都让我觉得是simple的典范. 无论如何, 我始终觉得豆瓣是一个技术很棒的企业. 这一切美好的印象只持续到我接触它的oauth之前.</p>

<p>还是先说有点, 豆瓣的oauth文档简介明了, 该说的都说清楚了. 另外豆瓣的错误信息返回的很厚道, 会把服务器拼出来的base string发给你, 让你和自己的好好比较一下, signature错误找起来就方便多了.</p>

<p>不过signature的错误你是永远也不会觉得好办的&#8230; 因为豆瓣太特别了. 在它的basestring里有一个多余的 &#8220;OAuth%2520&#8221; 请求的url之后, 所有参数之前. 百思不得其解这究竟是什么, 难道是历史原因造成的? 总之对于我来说要做的只不过是拼接basestring的时候硬加上去. (至今仍然希望高手解答, 之前的oauth版本里是这样的?)</p>

<p>解决了这个问题还没完, 还有问题. 我尝试使用拿回来的access_token去访问资源, 又报signature错误了. 具体问题我在豆瓣的<a href="http://www.douban.com/group/topic/18667209/">这个帖子</a>里详细描述了, 不过还没有得到答案. 在这个请求中我要不要加上oauth_callback_url这个参数是一回事, 它是不是参加排序又是另外一回事不是么? (至少不该是签名错误吧)</p>

<p>另外还有一个小问题, 豆瓣返回oauth_token=xxx&amp;oauth_token_secret=xxx也是排序错误的, 两个位置对调了. scribe-java是用正则去匹配的, 所以出错了.</p>

<p>总之豆瓣折腾的最疼, 难免心里有些失望.</p>

<p><strong>总结一下</strong></p>

<p>oauth的应用越来越广泛, 互联网企业拿着互联网开发的新年开发着自己的平台, 这是一件很好的事情.</p>

<p>从开发角度来说, 不得不承认oauth并不简单, 我也并不精通oauth, 偷懒了用了别人的库或多或少出现了些问题. 我依然比较郁闷的是, scribe-java本身自己就支持一大堆国外的oauth, 并且在我看来代码都是没有什么问题的, 到了国内, 标准就不是标准了, 标准只是参考, 各家各户按照自己的理解在做. 这篇文章写完, 我也有些心虚, 一些问题可能还是我有错, 如果你发现了, 欢迎拍砖我赔礼道歉.</p>

<p>最后提一下, 在<a href="https://github.com/Arthraim/scribe-java">github上</a>把scribe-java给folk了, 添加了4大门户的微博, 欢迎其他开发者使用或贡献.</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-04-08T04:12:47+08:00" pubdate data-updated="true">Apr 8<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/programing/'>Programing</a>


</div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/2011-03-19-technical-notes/">
		
			2011-03-19 技术小记</a>
	</h2>
	<div class="entry-content">
		<p>好久木有更新了，碰到一些素材或遇到过的问题都会在evernote里记一下，不过总觉得事情都不够大不足以单独写一篇文章，所以全都一起写一下好了。</p>

<p>在windows下用maven2，遇到一个错：<strong>编码 GBK 的不可映射字符</strong>，原因是windows版的maven2默认编码是GBK。如果有windows的参与者，那解决方法是在pom.xml里加入以下语句：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="nt">&lt;properties&gt;</span>
</span><span class='line'>    <span class="nt">&lt;project.build.sourceEncoding&gt;</span>UTF-8<span class="nt">&lt;/project.build.sourceEncoding&gt;</span>
</span><span class='line'>    <span class="nt">&lt;maven.compiler.encoding&gt;</span>UTF-8<span class="nt">&lt;/maven.compiler.encoding&gt;</span>
</span><span class='line'><span class="nt">&lt;/properties&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>另外后面一句是在使用mvn compile命令的时候才需要的。</p>

<p>via: <a href="http://wozailongyou.javaeye.com/blog/711664">http://wozailongyou.javaeye.com/blog/711664</a></p>

<hr />

<p>然后是git的一个问题。在某个java工程，git pull 的时候遇到如下错误：</p>

<blockquote><p>error: Untracked working tree file &#8216;webapp/WEB-INF/classes/com/arthraim/foo.class&#8217; would be overwritten by merge. Aborting</p></blockquote>

<p>不小心把.class加入到版本管理，并push到远程了。在另一个本地repo又把他们去掉了，于是就出了类似的错。解决方法大致是移出掉本地的文件（当然如果不是.class这样无所谓的文件的话，不妨备份他们先），并把他们从本地git仓库移出，确保在远程git仓库也移出。</p>

<p>这个问题解决的不是特别干净漂亮，说实话也并没深究。</p>

<hr />

<p>还是一个git的小问题，一直很顺的用 <code>git pull 仓库名 分支名</code> 和 <code>git push 仓库名 分支名</code> 突然有人问起本地分支和远程分支的命名不一样的时候怎么办。。。 还真是查了很久啊。发现原来git pull 语句是这样描述的：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='sh'><span class='line'>git push <span class="o">[</span>远程仓库名<span class="o">]</span> <span class="o">[</span>本地分支<span class="o">]</span> :<span class="o">[</span>远程分支<span class="o">]</span>
</span></code></pre></td></tr></table></div></figure>


<p>这个冒号很微妙啊。。以前都是偷懒了用了他的默认。</p>

<p>via: <a href="http://progit.org/book/zh/ch3-5.html">http://progit.org/book/zh/ch3-5.html</a></p>

<hr />

<p>最后一个是freemarker遇到的问题，后端Double类型的数据在freemarker转成string的时候会默认取3位小数，所以这又是和上一个问题类似的被默认耍了的事情。写成下面这样就可以控制最大小数点数位：</p>

<p>${some_double_number?string(0.######)}</p>

<p>&#8217;#&#8217;的数量你懂的。更多具体的选项请看下面的链接。</p>

<p>via: <a href="http://gongstring.javaeye.com/blog/405270">http://gongstring.javaeye.com/blog/405270</a></p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-03-19T23:26:22+08:00" pubdate data-updated="true">Mar 19<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/programing/'>Programing</a>


</div>
	
</div></article>


    <article class="post">
	<h2 class="title">
		
		<a href="/nginx-411-error/">
		
			Nginx返回411错误</a>
	</h2>
	<div class="entry-content">
		<p>今天提交一个form的时候遇到一个411错误, 当时我就孤陋寡闻, 第一次见到411, 查了一下然后就囧了, 是nginx直接把请求给弹回来了. 深入的查一下之后发现这个问题还是非常容易引起的, 于是我当时很奇怪的是在之前的开发中难道从来没有遇到过? 话说也是不良习惯造成的问题, 生产环境测试环境都没有nginx, 唯独产品服务器上是, 糟糕吧.</p>

<h2>引发411的原因</h2>

<p>nginx给出的官方解释有三种情况会引发nginx弹411回去</p>

<ol>
<li>client sent invalid &#8220;Content-Length&#8221; header</li>
<li>client sent … method without &#8220;Content-Length&#8221; header</li>
<li>client sent &#8220;Transfer-Encoding: chunked&#8221; header</li>
</ol>


<p>我的场景是这样的, 用httpclient4(java)去调用一个api服务, 这个api使用的server正是nginx, 使用multipart提交图片文件的时候因为它忽略或省略了文件的真正的长度, 所以(通过firebug发现)在request header里就压根没有Content-Length. 那显然符合上面的第二种情况.</p>

<h2>改代码</h2>

<p>然后我尝试通过修改代码来解决, 自己填充这个header, 但是httpclient很硬气, 我写了一句</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='nginx'><span class='line'><span class="k">header</span> <span class="s">httppost.setHeader(&quot;Content-Length&quot;,</span> <span class="s">&quot;0&quot;)</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure>


<p>它直接就报错了</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='nginx'><span class='line'><span class="k">org.apache.http.ProtocolException:</span> <span class="s">Content-Length</span> <span class="s">header</span> <span class="s">already</span> <span class="s">present</span> <span class="s">at</span> <span class="s">org.apache.http.protocol.RequestContent.process(RequestContent.java:67)</span>  <span class="s">......</span>
</span></code></pre></td></tr></table></div></figure>


<p>看来想在包外面改还不是那么容易, 算了, 继续Google, 一定有合理的办法. <strong>不用改代码.</strong></p>

<h2>重新编译nginx</h2>

<p>于是Google了一圈又看到了<a href="http://www.lamnk.com/blog/computer/fix-nginx-411-length-required-error/">这个文章</a>, 遇到同样的问题, 只是它是上面说到的第三种情况, 不过很幸运的是我意识到解决的方法可能是一样的 &#8211; 给nginx加上一个Chunkin模块. 说干就干, 参考了<a href="http://wiki.nginx.org/NginxHttpChunkinModule#Installation">nginx的wik</a>i和<a href="http://www.shenzhen3c.com/archives/360">这篇文章</a>, 可以顺利的加上外部的模块. 简单来说是以下几步:</p>

<ol>
<li><p>下载新版nginx(或者你还有原来的nginx代码在?), 并下载nginxHttpChunkinModule, 然后解压缩. (下载地址就不帖了, 前者版本更新很快, 后者最近又在开始更新支持DELETE方法了)</p></li>
<li><p><code>nginx -V</code> 查一下之前编译nginx时候的参数, 并且记下来</p></li>
<li><p><code>./configure</code> 并加上一堆参数, 尤其记得要加上 <code>--add-module=/path/to/your/module</code></p></li>
<li><p><code>make</code> (不要马上<code>make install</code>)</p></li>
</ol>


<h2>不停掉nginx, 平滑过渡到新版本</h2>

<p>这才是最最技术的活&#8230; 参考&lt;实战nginx>(in action), 可以简单归纳为以下几步</p>

<ol>
<li><p>备份原来的nginx可执行文件, 比如nginx_bak</p></li>
<li><p><code>cp obj/nginx</code>到旧的nginx可执行文件的位置, 因为它还在跑所以要加上参数 <code>-f</code></p></li>
<li><p><code>kill -USR2 旧版本的nginx主进程号</code> (用<code>ps aux | grep nginx</code>找到, 除了主进程还有一个worker process), 之后再ps会发现一个新的nginx进程被启动, 并且一个新的worker process也开始启动. 这个时候它们同时在工作.</p></li>
<li><p><code>kill - WHINCH 旧版本的nginx主进程号</code> 这会让旧的nginx进程不再处理新的请求, 过一段时间之后再ps, 会看到旧的worker process已经消失停止了. 这时候所有的请求都交给新的nginx在处理了.</p></li>
<li><p><code>kill -QUIT 旧版本的nginx主进程号</code> 退出旧的进程, 新的进程就可以使用了.</p></li>
</ol>


<p>当然这个平滑过渡适用版本升级等各种更换nginx可执行文件的情况, 所以再额外提一下如果发现新版本不好要退回去的时候怎么办.</p>

<ul>
<li><p><code>kill -HUP 旧的nginx主进程号</code> 不reload配置文件就直接重新启动旧的nginx</p></li>
<li><p><code>kill -QUIT 新的nginx主进程号</code> 从容关闭新的Nginx实例</p></li>
<li><p><code>kill -TERM 新的nginx主进程号</code> 这个和上面的可以二选一</p></li>
<li><p>之后可以把之前的nginx_bak重新复制回来覆盖新的</p></li>
</ul>


<p>当然以上都是文明人的做法, 想施暴也是可以的&#8230;</p>

<h2>修改nginx的配置文件</h2>

<p>然后要改一下配置, 使新的模块生效</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='nginx'><span class='line'><span class="k">chunkin</span> <span class="no">on</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="k">error_page</span> <span class="mi">411</span> <span class="p">=</span> <span class="s">@my_411_error</span><span class="p">;</span>
</span><span class='line'><span class="k">location</span> <span class="s">@my_411_error</span> <span class="p">{</span>
</span><span class='line'>    <span class="kn">chunkin_resume</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="k">location</span> <span class="s">/foo</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1"># your fastcgi_pass/proxy_pass/set/if and</span>
</span><span class='line'>    <span class="c1"># any other config directives go here...</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="k">...</span>
</span></code></pre></td></tr></table></div></figure>


<p>这样改过之后reload nginx就可以正常工作了, 详细配置方法请参考<a href="http://wiki.nginx.org/NginxHttpChunkinModule">wiki</a>谢谢.</p>

<p>那么做到这里之前的问题就解决了, 记录一下, 因为在其他环境下都没遇到类似问题.</p>

<p>以上</p>

		
		
	</div>


<div class="meta">
	<div class="date">








  


<time datetime="2011-02-24T03:26:52+08:00" pubdate data-updated="true">Feb 24<span>th</span>, 2011</time></div>
	<div class="tags">


	<a class='category' href='/blog/categories/programing/'>Programing</a>


</div>
	
</div></article>

<nav id="pagenavi">
    
        <a href="/" class="prev">Prev</a>
    
    
        <a href="/blog/page/3/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
	<footer id="footer" class="inner">Copyright &copy; 2013

    Arthur Wang

</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'artorius';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-8352384-7']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>



</body>
</html>